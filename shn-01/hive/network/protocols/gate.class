--[[
    SHN-01 Network Gate Protocol Class
        This class represents the GATE protocol in the SHN-01 system.
        It handles the handshake sequence and client verification process.
]]
local command = newClass(class("../protocol"))

function command:constructor(hive)
    assert(self, "Must be called on a object")
    
    -- Create sequences FIRST
    local sequenceClass = class("../sequence")
    local handshakeSeq = sequenceClass.create(hive, self, getAbsolutePath("../sequences/handshake/manifest.lua"), true)
    local disconnectSeq = sequenceClass.create(hive, self, getAbsolutePath("../sequences/disconnect/manifest.lua"), true)
    
    -- Initialize protocol properties directly
    self.server = hive
    self.name = "GATE"
    self.description = "Response Verification"
    self.port = 2011
    
    -- Create unique sequences table for this protocol instance
    self.sequences = setmetatable({}, {__name = "sequences_for_GATE"})
    local sequences = {handshakeSeq, disconnectSeq}
    for i, seq in ipairs(sequences) do
        self.sequences[seq.name] = seq
    end
end

return command
